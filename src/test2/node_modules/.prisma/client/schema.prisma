// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}
datasource db {
  provider = "mysql"
  url = env("DATABASE_URL")
  relationMode = "prisma"
}

model User {
  UserId String @id @default(cuid())
  username String 
  email String
  password String
  isAdmin Boolean @default(false)
  isVendor Boolean @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  products Product[]
  orders Order[]
  carts Cart[]
}


model Product {
  ProductId String @id @default(cuid())
  vendor User @relation(fields: [vendorId], references: [UserId])
  vendorId String
  title String
  desc String
  img String
  size String
  color String
  price Int
  orders Order_Product[]
  carts Cart_Product[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([vendorId])
}

model Order {
  OrderId String @id @default(cuid())
  User User @relation(fields: [UserId], references: [UserId])
  UserId String
  products Order_Product[]
  address String
  status String @default("pending")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([UserId])
}

model Order_Product {
  Order Order @relation(fields: [OrderId], references: [OrderId])
  OrderId String
  Product Product @relation(fields: [ProductId], references: [ProductId])
  ProductId String
  amount Int

  @@id([OrderId,ProductId])
  @@index([OrderId])
  @@index([ProductId])
}

model Cart{
  CartId String @id @default(cuid())
  User User @relation(fields: [UserId], references: [UserId])
  UserId String
  products Cart_Product[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt


  @@index([UserId])
}

model Cart_Product {
  Cart Cart @relation(fields: [CartId],references: [CartId])
  CartId String
  Product Product @relation(fields: [ProductId],references: [ProductId])
  ProductId String
  amount Int

  @@id([CartId,ProductId])
  @@index([CartId])
  @@index([ProductId])
}
